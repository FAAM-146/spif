
# SPIF - Single Particle Image Format

<!--
For full information on the SPIF data standard and usage examples see [paper_placeholder](https://github.com/graemenott/spif-paper).
-->

## Background and Motivation

The SPIF data standard was conceived as an open and accessible means of storing individual cloud particle images. Real-time images of liquid and ice particles from aircraft are routinely generated by optical array probes (OAPs) \[[Knollenberg, 1970](https://doi.org/10.1175/1520-0450(1970)009<0086:TOAAAT>2.0.CO;2)\]. OAPs use a one-dimensional photodiode array to record successive slices of an image of the shadow that is cast by a particle as it moves across the instrument's sample volume. The use of such instruments has lead to decades worth of in situ cloud particle-by-particle data taken across the gamut of pristine and anthropogenically-modified \[[Quaas, 2015](https://doi.org/10.1007/s40641-015-0028-0)\] cloud types. More recently, probes using two dimensional imagers, such as the [SPEC](http://www.specinc.com) CPI (Cloud Particle Imager) \[[Lawson et al., 2001](https://agupubs.onlinelibrary.wiley.com/doi/10.1029/2000JD900789)\] and HOLODEC (Holographic Detector for Clouds) \[[Fugal & Shaw, 2009](https://amt.copernicus.org/articles/2/259/2009/)\] have been used to produce very high resolution images with greater colour depth of cloud particles.

Image data from such probes is recorded in proprietry and instrument- or system-specific formats. Binary formats have evolved due to the limitations of legacy hardware and limited system bandwidths. This means that is a significant barrier to new users of image data, particularly for users that are not from fields that have traditionally used such cloud data. Fields such as remote sensing and atmospheric process modelling may well benefit by being able to ingest raw cloud particle data into their processing streams as these applications may require specialised or different processing options to those normally used by those in the cloud measurement community.

The SPIF standard has been designed so that decoded raw binary data can stored in a [NetCDF4](https://www.unidata.ucar.edu/software/netcdf/) file structure with a standardised vocabulary in accordance with [FAIR Guiding Principles](https://www.go-fair.org/fair-principles/) \[[Wilkinson et al., 2016](https://www.nature.com/articles/sdata201618)\]. It is hoped that this will improve access to this data for users from a wide range of fields and facilitate the sharing, refinement, and standardisation of data processing routines (for a discussion on inconsistencies between current particle processing routines see [McFarquhar et al., 2017](https://doi.org/10.1175/AMSMONOGRAPHS-D-16-0007.1)).


## SPIF Files

The SPIF standard is a standardised vocabulary for storing image data and metadata in [NetCDF4](https://www.unidata.ucar.edu/software/netcdf/) files. NetCDF allows for fully self-describing, archival standard data and is supported on a variety of platforms, environments, and programming languages and commonly used in earth science communities. Conventions and best practice guides such as [Attribute Convention for Dataset Discover (ACDD)](https://wiki.esipfed.org/Attribute_Convention_for_Data_Discovery_1-3) and [CF (Climate and Forecast) Conventions](http://cfconventions.org/) are used to standardise the netCDF4 metadata and variable structures to suit a particular field and so facilitate access, standard workflows, and comparison between datasets. In a similar fashion to the CF Conventions; SPIF defines a minimum vocabulary, that is groups, variables, and attributes, that must be included for compliance. Any additional data contained within the file is optional but should not conflict with the standards. SPIF has been called a format standard, rather than a convention, as it stipulates the form of the variable data as well as variable attributes. It is possible to create a SPIF file that is also compliant with ACDD, CF, other conventions, and organisational requirements.


## SPIF File Structure

SPIF files use NetCDF4 groups to divide instruments and separate image and other data. Some of these groups and their contents are required,

root\
  ├ :Conventions = "SPIF-1.0"\
  ├── \<instrument-1\>\
  │   ├ :instrument_name\
  │   ├ :instrument_long_name\
  │   ├ ``float32`` color_level(pixel_colors)\
  │   ├ ``int32`` array_size(array_dimensions)\
  │   ├ ``int32`` image_size(array_dimensions)\
  │   ├ ``float32`` resolution(array_dimensions)\
  │   ├ ``float32`` wavelength()\
  │   ├ ``float32`` pathlength()\
  │   │
  │   └── core\
  │       ├ ``uint8`` image(pixel)\
  │       ├ ``uint64`` timestamp(image_num)\
  │       │   └ :standard_name = "time"\
  │       ├ ``uint32`` startpixel(image_num)\
  │       ├ ``uint8`` width(image_num)\
  │       ├ ``uint8`` height(image_num)\
  │       └ ``byte`` overload(image_num)\
  │\
  │\
  ├── ***\<instrument-2\>***\
  │   └── ...\
  │\
  └── ...




## Image Data


